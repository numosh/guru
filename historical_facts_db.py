"""
Historical Facts Database - GURU AI
Database fakta sejarah Indonesia yang akurat untuk RAG system

PENTING: Semua fakta sudah diverifikasi dari sumber terpercaya
Author: GURU AI Enhancement Project
Date: 2025-01-06
"""

# ==================== PAHLAWAN REVOLUSI ====================

PAHLAWAN_REVOLUSI = {
    "definition": "Gelar kehormatan yang diberikan kepada 7 perwira TNI yang gugur dalam Peristiwa G30S/PKI pada 30 September - 1 Oktober 1965",

    "names": [
        {
            "name": "Jenderal TNI Anumerta Ahmad Yani",
            "rank": "Jenderal TNI",
            "position": "Menteri/Panglima Angkatan Darat",
            "birth": "19 Juni 1922",
            "death": "1 Oktober 1965",
            "age_at_death": 43
        },
        {
            "name": "Letjen TNI Anumerta Raden Suprapto",
            "rank": "Letnan Jenderal TNI",
            "position": "Deputi II Menteri/Panglima AD bidang Administrasi",
            "birth": "20 Juni 1920",
            "death": "1 Oktober 1965",
            "age_at_death": 45
        },
        {
            "name": "Letjen TNI Anumerta Mas Tirtodarmo Haryono",
            "rank": "Letnan Jenderal TNI",
            "position": "Deputi III Menteri/Panglima AD bidang Perencanaan dan Pembinaan",
            "birth": "20 Januari 1924",
            "death": "1 Oktober 1965",
            "age_at_death": 41
        },
        {
            "name": "Letjen TNI Anumerta Siswondo Parman",
            "rank": "Letnan Jenderal TNI",
            "position": "Asisten I Menteri/Panglima AD bidang Intelijen",
            "birth": "4 Agustus 1918",
            "death": "1 Oktober 1965",
            "age_at_death": 47
        },
        {
            "name": "Mayjen TNI Anumerta Donald Isaac Panjaitan",
            "rank": "Mayor Jenderal TNI",
            "position": "Asisten IV Menteri/Panglima AD bidang Logistik",
            "birth": "9 Juni 1925",
            "death": "1 Oktober 1965",
            "age_at_death": 40
        },
        {
            "name": "Mayjen TNI Anumerta Sutoyo Siswomiharjo",
            "rank": "Mayor Jenderal TNI",
            "position": "Inspektur Kehakiman/Oditur Jenderal Angkatan Darat",
            "birth": "28 Agustus 1922",
            "death": "1 Oktober 1965",
            "age_at_death": 43
        },
        {
            "name": "Kapten CZI Anumerta Pierre Andreas Tendean",
            "rank": "Kapten CZI (Corps Zeni Infanteri)",
            "position": "Ajudan Jenderal Abdul Haris Nasution",
            "birth": "21 Februari 1939",
            "death": "1 Oktober 1965",
            "age_at_death": 26
        }
    ],

    "event": {
        "name": "Gerakan 30 September (G30S/PKI)",
        "date": "30 September - 1 Oktober 1965",
        "time": "Dini hari 1 Oktober 1965",
        "description": "Kudeta yang dilakukan oleh PKI untuk menggulingkan pemerintahan",
        "perpetrators": "Pasukan Cakrabirawa dan PKI",
        "year_after_independence": 20
    },

    "location": {
        "abduction": "Rumah masing-masing perwira di Jakarta",
        "murder_site": "Lubang Buaya, Jakarta Timur",
        "burial": "Sumur tua di Lubang Buaya (dibuang ke dalam sumur)"
    },

    "monument": {
        "name": "Monumen Pancasila Sakti",
        "location": "Jl. Raya Pondok Gede, Lubang Buaya, Jakarta Timur",
        "established": "1 Oktober 1966",
        "purpose": "Mengenang jasa dan pengorbanan 7 Pahlawan Revolusi"
    },

    "common_misconceptions": [
        {
            "wrong": "Pahlawan Revolusi = Soekarno, Hatta, Sudirman",
            "correct": "Soekarno, Hatta, Sudirman adalah Pahlawan Nasional, bukan Pahlawan Revolusi"
        },
        {
            "wrong": "Pahlawan Revolusi berperan dalam perjuangan kemerdekaan 1945",
            "correct": "Pahlawan Revolusi gugur dalam G30S/PKI tahun 1965, 20 tahun setelah kemerdekaan"
        },
        {
            "wrong": "Pahlawan Revolusi melawan Belanda",
            "correct": "Pahlawan Revolusi adalah korban kudeta PKI, bukan perang melawan Belanda"
        }
    ],

    "keywords": [
        "pahlawan revolusi",
        "g30s",
        "g 30 s",
        "pki",
        "lubang buaya",
        "lobang buaya",
        "30 september",
        "1 oktober 1965",
        "gerakan 30 september"
    ]
}

# ==================== LUBANG BUAYA ====================

LUBANG_BUAYA = {
    "monument": "Monumen Pancasila Sakti",
    "full_name": "Monumen Pancasila Sakti Lubang Buaya",

    "address": {
        "street": "Jl. Raya Pondok Gede",
        "area": "Lubang Buaya",
        "district": "Cipayung",
        "city": "Jakarta Timur",
        "postal_code": "13810"
    },

    "statues": [
        "Patung Jenderal TNI Ahmad Yani",
        "Patung Letjen TNI R. Suprapto",
        "Patung Letjen TNI M.T. Haryono",
        "Patung Letjen TNI S. Parman",
        "Patung Mayjen TNI D.I. Panjaitan",
        "Patung Mayjen TNI Sutoyo Siswomiharjo",
        "Patung Kapten CZI Pierre Tendean"
    ],

    "number_of_statues": 7,
    "statue_description": "7 patung perunggu dari 7 Pahlawan Revolusi yang gugur dalam G30S/PKI",

    "facilities": [
        "Museum Pengkhianatan PKI",
        "Sumur Tua (tempat pembuangan jenazah)",
        "Diorama peristiwa G30S/PKI",
        "Taman memorial",
        "Ruang pameran",
        "Area parkir"
    ],

    "historical_significance": "Tempat pembunuhan dan pembuangan jenazah 7 Pahlawan Revolusi oleh PKI pada 1 Oktober 1965",

    "common_misconceptions": [
        {
            "wrong": "Ada patung Jenderal Sudirman di Lubang Buaya",
            "correct": "Tidak ada patung Sudirman. Yang ada adalah 7 patung Pahlawan Revolusi korban G30S/PKI"
        },
        {
            "wrong": "Lubang Buaya berkaitan dengan perjuangan kemerdekaan",
            "correct": "Lubang Buaya berkaitan dengan tragedi G30S/PKI tahun 1965, bukan perjuangan kemerdekaan"
        }
    ],

    "keywords": [
        "lubang buaya",
        "lobang buaya",
        "patung",
        "monumen pancasila sakti",
        "jenderal",
        "g30s"
    ]
}

# ==================== SOEHARTO ====================

SOEHARTO = {
    "name": "Soeharto",
    "fullName": "Soeharto",

    "birth": {
        "date": "8 Juni 1921",
        "place": "Kemusuk, Argomulyo, Yogyakarta"
    },

    "death": {
        "date": "27 Januari 2008",
        "place": "Jakarta",
        "age": 86
    },

    "roles": [
        "Presiden Republik Indonesia ke-2 (1967-1998)",
        "Panglima Komando Strategis Angkatan Darat (Pangkostrad)",
        "Jenderal TNI"
    ],

    "military_career": [
        {
            "period": "1940-1942",
            "role": "Tentara KNIL (Koninklijk Nederlandsch-Indisch Leger)",
            "note": "Tentara Hindia Belanda"
        },
        {
            "period": "1943-1945",
            "role": "Tentara PETA (Pembela Tanah Air)",
            "note": "Dibentuk oleh Jepang"
        },
        {
            "period": "1945-1949",
            "role": "Tentara Republik Indonesia",
            "note": "Berperang MELAWAN Belanda dalam Perang Kemerdekaan (BUKAN melawan RI!)"
        },
        {
            "period": "1965",
            "role": "Pangkostrad (Panglima Komando Strategis AD)",
            "note": "Memimpin penumpasan G30S/PKI"
        }
    ],

    "presidential_period": {
        "start": "1967",
        "end": "1998",
        "duration": "31 tahun",
        "era_name": "Orde Baru"
    },

    "major_events": [
        {
            "year": 1965,
            "event": "Penumpasan G30S/PKI",
            "description": "Memimpin operasi penumpasan kudeta PKI"
        },
        {
            "year": 1966,
            "event": "Supersemar (Surat Perintah Sebelas Maret)",
            "description": "Menerima mandat dari Soekarno untuk mengambil tindakan keamanan dan menyelamatkan negara"
        },
        {
            "year": 1967,
            "event": "Pelantikan sebagai Pejabat Presiden",
            "description": "MPRS melantik Soeharto sebagai Pejabat Presiden menggantikan Soekarno"
        },
        {
            "year": 1968,
            "event": "Presiden Penuh",
            "description": "Dilantik sebagai Presiden RI ke-2 secara penuh"
        },
        {
            "year": 1998,
            "event": "Pengunduran Diri",
            "description": "Mengundurkan diri akibat tekanan Reformasi dan krisis moneter 1997-1998"
        }
    ],

    "achievements": [
        "Pembangunan ekonomi pesat (pertumbuhan rata-rata 7% per tahun pada 1970-1990an)",
        "Swasembada pangan (1984) - Indonesia mampu memenuhi kebutuhan beras sendiri",
        "Pembangunan infrastruktur nasional (jalan, jembatan, irigasi, listrik)",
        "Pengentasan kemiskinan (dari ~60% menjadi ~15%)",
        "Stabilitas politik selama 31 tahun",
        "Transmigrasi - perpindahan penduduk dari Jawa ke luar Jawa"
    ],

    "controversies": [
        "Pelanggaran HAM (Tragedi Trisakti, Semanggi I & II, Tanjung Priok, Talangsari, dll)",
        "Korupsi, Kolusi, dan Nepotisme (KKN) yang sistematis",
        "Pembatasan kebebasan pers (hanya 3 TV: TVRI, RCTI, SCTV)",
        "Pembatasan kebebasan berpendapat dan berserikat",
        "Sentralisasi kekuasaan (dwifungsi ABRI)",
        "Konflik di Timor Timur, Aceh, Papua"
    ],

    "legacy": {
        "positive": [
            "Pembangunan ekonomi dan infrastruktur yang pesat",
            "Stabilitas politik jangka panjang",
            "Swasembada pangan",
            "Pengurangan kemiskinan signifikan"
        ],
        "negative": [
            "Pelanggaran HAM yang sistematis",
            "Korupsi masif (diperkirakan triliunan rupiah)",
            "Pembatasan demokrasi dan kebebasan",
            "Krisis moneter 1997-1998 yang menghancurkan ekonomi"
        ]
    },

    "common_misconceptions": [
        {
            "wrong": "Soeharto berperang melawan Republik Indonesia",
            "correct": "Soeharto berperang MELAWAN Belanda pada 1945-1949 sebagai prajurit TNI dalam Perang Kemerdekaan"
        },
        {
            "wrong": "Soeharto menggulingkan Soekarno dengan kudeta militer",
            "correct": "Transisi kekuasaan melalui Supersemar (1966) dan proses politik bertahap melalui MPRS"
        },
        {
            "wrong": "Orde Baru hanya membawa kehancuran",
            "correct": "Orde Baru memiliki pencapaian ekonomi signifikan, namun juga pelanggaran HAM dan korupsi masif"
        }
    ],

    "context": "Soeharto adalah presiden terlama di Indonesia (31 tahun). Era kepemimpinannya (Orde Baru) ditandai oleh pembangunan ekonomi pesat namun juga otoritarianisme, KKN, dan pelanggaran HAM. Ia mengundurkan diri tahun 1998 akibat Reformasi.",

    "keywords": [
        "soeharto",
        "suharto",
        "orde baru",
        "orba",
        "presiden kedua",
        "supersemar",
        "reformasi 1998",
        "pembangunan",
        "kkn"
    ]
}

# ==================== G30S/PKI ====================

G30S_PKI = {
    "full_name": "Gerakan 30 September/Partai Komunis Indonesia",
    "abbreviation": "G30S/PKI",
    "alternative_names": ["Gestapu", "Gestok"],

    "date": "30 September - 1 Oktober 1965",
    "time": "Dini hari 1 Oktober 1965",
    "year": 1965,

    "description": "Upaya kudeta yang dilakukan oleh PKI untuk menggulingkan pemerintahan Soekarno",

    "perpetrators": [
        "DN Aidit (Ketua CC PKI)",
        "Letkol Untung Syamsuri (Komandan Pasukan Cakrabirawa)",
        "Kolonel Abdul Latief",
        "Mayor Udara Sujono"
    ],

    "victims": [
        "7 perwira TNI (kemudian diberi gelar Pahlawan Revolusi)",
        "AIP KS Brigadir Polisi Karel Satsuit Tubun (tewas saat mencoba melindungi Jenderal Nasution)"
    ],

    "survivors": [
        {
            "name": "Jenderal Abdul Haris Nasution",
            "position": "Menteri Koordinator Pertahanan dan Keamanan",
            "note": "Berhasil meloloskan diri dengan melompat pagar, tetapi putrinya Ade Irma Suryani Nasution tewas tertembak"
        }
    ],

    "chronology": [
        {
            "time": "Dini hari 1 Oktober 1965",
            "event": "Pasukan G30S menculik 7 perwira TNI dari rumah mereka"
        },
        {
            "time": "Pagi 1 Oktober 1965",
            "event": "Jenazah 7 perwira dibuang ke sumur tua di Lubang Buaya"
        },
        {
            "time": "1 Oktober 1965",
            "event": "Soeharto (Pangkostrad) mengambil alih kepemimpinan AD"
        },
        {
            "time": "3 Oktober 1965",
            "event": "Jenazah 7 pahlawan ditemukan di Lubang Buaya"
        },
        {
            "time": "5 Oktober 1965",
            "event": "Pemakaman 7 pahlawan di TMP Kalibata"
        }
    ],

    "aftermath": [
        "Jatuhnya pengaruh PKI di Indonesia",
        "Peralihan kekuasaan dari Soekarno ke Soeharto",
        "Dimulainya Orde Baru (1966)",
        "Pembersihan PKI secara nasional",
        "Supersemar (11 Maret 1966)"
    ],

    "context": "Peristiwa ini terjadi 20 tahun SETELAH kemerdekaan Indonesia (1945), bukan bagian dari perjuangan kemerdekaan",

    "keywords": [
        "g30s",
        "g 30 s",
        "pki",
        "gerakan 30 september",
        "gestapu",
        "kudeta",
        "1965",
        "soeharto",
        "orde baru"
    ]
}

# ==================== DISAMBIGUATION (Penting untuk menghindari confusion) ====================

DISAMBIGUATION = {
    "pahlawan_nasional_vs_pahlawan_revolusi": {
        "pahlawan_nasional": {
            "definition": "Gelar yang diberikan kepada warga negara Indonesia yang berjasa luar biasa dalam perjuangan kemerdekaan atau pembangunan bangsa",
            "jumlah": "Lebih dari 190 orang (terus bertambah)",
            "contoh": [
                "Soekarno (Proklamator)",
                "Mohammad Hatta (Proklamator)",
                "Jenderal Sudirman (Panglima Besar TNI)",
                "Cut Nyak Dien (Pahlawan dari Aceh)",
                "Pangeran Diponegoro (Pemimpin Perang Jawa)",
                "Ki Hajar Dewantara (Bapak Pendidikan)",
                "R.A. Kartini (Pelopor emansipasi wanita)"
            ],
            "periode": "Sejak masa penjajahan hingga masa kemerdekaan dan pembangunan"
        },

        "pahlawan_revolusi": {
            "definition": "Gelar khusus untuk 7 perwira TNI yang gugur dalam G30S/PKI",
            "jumlah": "HANYA 7 orang (fixed, tidak akan bertambah)",
            "nama": [
                "Jenderal Ahmad Yani",
                "Letjen R. Suprapto",
                "Letjen M.T. Haryono",
                "Letjen S. Parman",
                "Mayjen D.I. Panjaitan",
                "Mayjen Sutoyo Siswomiharjo",
                "Kapten Pierre Tendean"
            ],
            "periode": "1 Oktober 1965 (satu peristiwa spesifik)",
            "konteks": "Korban kudeta G30S/PKI, BUKAN perjuangan kemerdekaan"
        },

        "key_difference": "Pahlawan Nasional = kategori umum untuk pejuang kemerdekaan/pembangunan. Pahlawan Revolusi = gelar spesifik untuk 7 korban G30S/PKI tahun 1965."
    }
}

# ==================== RETRIEVAL FUNCTIONS ====================

def get_facts_pahlawan_revolusi():
    """Mendapatkan fakta tentang Pahlawan Revolusi"""
    return PAHLAWAN_REVOLUSI

def get_facts_lubang_buaya():
    """Mendapatkan fakta tentang Lubang Buaya"""
    return LUBANG_BUAYA

def get_facts_g30s_pki():
    """Mendapatkan fakta tentang G30S/PKI"""
    return G30S_PKI

def get_disambiguation():
    """Mendapatkan klarifikasi perbedaan konsep"""
    return DISAMBIGUATION

def get_facts_soeharto():
    """Mendapatkan fakta tentang Soeharto"""
    return SOEHARTO

def detect_query_type(query):
    """
    Deteksi jenis pertanyaan dari user
    Returns: 'pahlawan_revolusi', 'lubang_buaya', 'g30s_pki', 'soeharto', or None
    """
    query_lower = query.lower()

    # Check Soeharto
    soeharto_keywords = ["soeharto", "suharto", "orde baru", "orba", "supersemar"]
    if any(kw in query_lower for kw in soeharto_keywords):
        return 'soeharto'

    # Check Pahlawan Revolusi
    pr_keywords = ["pahlawan revolusi", "pahlawan revolusi"]
    if any(kw in query_lower for kw in pr_keywords):
        return 'pahlawan_revolusi'

    # Check Lubang Buaya
    lb_keywords = ["lubang buaya", "lobang buaya", "monumen pancasila sakti"]
    if any(kw in query_lower for kw in lb_keywords):
        # If asking about statues/monuments
        if any(word in query_lower for word in ["patung", "monumen", "jenderal", "siapa"]):
            return 'lubang_buaya'

    # Check G30S/PKI
    g30s_keywords = ["g30s", "g 30 s", "gestapu", "gerakan 30 september", "30 september 1965"]
    if any(kw in query_lower for kw in g30s_keywords):
        return 'g30s_pki'

    return None

def retrieve_historical_facts(query):
    """
    Main retrieval function - mengembalikan fakta yang relevan
    Returns: dict dengan facts dan type, atau None jika tidak ada
    """
    query_type = detect_query_type(query)

    if query_type == 'soeharto':
        return {
            'type': 'soeharto',
            'facts': get_facts_soeharto()
        }

    elif query_type == 'pahlawan_revolusi':
        return {
            'type': 'pahlawan_revolusi',
            'facts': get_facts_pahlawan_revolusi(),
            'disambiguation': get_disambiguation()
        }

    elif query_type == 'lubang_buaya':
        return {
            'type': 'lubang_buaya',
            'facts': get_facts_lubang_buaya(),
            'related': get_facts_pahlawan_revolusi()  # Karena patung adalah dari Pahlawan Revolusi
        }

    elif query_type == 'g30s_pki':
        return {
            'type': 'g30s_pki',
            'facts': get_facts_g30s_pki(),
            'related': get_facts_pahlawan_revolusi()
        }

    return None

def format_facts_for_prompt(facts_data):
    """
    Format facts menjadi string yang bisa di-inject ke prompt
    """
    if not facts_data:
        return ""

    fact_type = facts_data['type']
    facts = facts_data['facts']

    if fact_type == 'soeharto':
        misconceptions_str = "\n".join([
            f"‚ùå SALAH: {m['wrong']}\n‚úÖ BENAR: {m['correct']}"
            for m in facts['common_misconceptions']
        ])

        career_str = "\n".join([
            f"- {c['period']}: {c['role']} ({c['note']})"
            for c in facts['military_career']
        ])

        return f"""
üîç FAKTA REFERENSI WAJIB (Soeharto):

IDENTITAS:
- Nama: {facts['name']}
- Lahir: {facts['birth']['date']} di {facts['birth']['place']}
- Wafat: {facts['death']['date']} di {facts['death']['place']} (usia {facts['death']['age']})

JABATAN UTAMA:
{chr(10).join(f"- {role}" for role in facts['roles'])}

KARIR MILITER:
{career_str}

PERIODE KEPRESIDENAN:
- Masa jabatan: {facts['presidential_period']['start']} - {facts['presidential_period']['end']}
- Durasi: {facts['presidential_period']['duration']}
- Era: {facts['presidential_period']['era_name']}

PENCAPAIAN:
{chr(10).join(f"- {a}" for a in facts['achievements'])}

KONTROVERSI:
{chr(10).join(f"- {c}" for c in facts['controversies'])}

KESALAHAN UMUM YANG HARUS DIHINDARI:
{misconceptions_str}

KONTEKS:
{facts['context']}

PENTING:
- Soeharto berperang MELAWAN Belanda (1945-1949), BUKAN melawan RI!
- Transisi kekuasaan melalui Supersemar (1966), bukan kudeta
- Legacy-nya kompleks: ada pencapaian ekonomi, tapi juga KKN & pelanggaran HAM

GUNAKAN FAKTA DI ATAS. JANGAN MENGARANG!
"""

    elif fact_type == 'pahlawan_revolusi':
        names = [f"- {p['name']} ({p['rank']}, {p['position']})" for p in facts['names']]
        names_str = "\n".join(names)

        return f"""
üîç FAKTA REFERENSI WAJIB (Pahlawan Revolusi):

DEFINISI:
{facts['definition']}

7 NAMA PAHLAWAN REVOLUSI:
{names_str}

PERISTIWA:
- Nama: {facts['event']['name']}
- Tanggal: {facts['event']['date']}
- Konteks: Terjadi {facts['event']['year_after_independence']} tahun SETELAH kemerdekaan

LOKASI:
- Penculikan: {facts['location']['abduction']}
- Pembunuhan: {facts['location']['murder_site']}
- Pembuangan jenazah: {facts['location']['burial']}

PENTING:
- Pahlawan Revolusi BERBEDA dengan Pahlawan Nasional
- Soekarno, Hatta, Sudirman adalah Pahlawan Nasional, BUKAN Pahlawan Revolusi
- Pahlawan Revolusi = 7 perwira korban G30S/PKI tahun 1965
- TIDAK ada hubungan dengan perjuangan kemerdekaan 1945

GUNAKAN FAKTA DI ATAS. JANGAN MENGARANG!
"""

    elif fact_type == 'lubang_buaya':
        statues_str = "\n".join([f"{i+1}. {s}" for i, s in enumerate(facts['statues'])])

        return f"""
üîç FAKTA REFERENSI WAJIB (Lubang Buaya):

MONUMEN:
- Nama: {facts['monument']}
- Alamat: {facts['address']['street']}, {facts['address']['area']}, {facts['address']['city']}

PATUNG-PATUNG ({facts['number_of_statues']} patung):
{statues_str}

DESKRIPSI:
{facts['statue_description']}

SIGNIFIKANSI HISTORIS:
{facts['historical_significance']}

PENTING:
- TIDAK ADA patung Jenderal Sudirman di Lubang Buaya
- Yang ada HANYA 7 patung Pahlawan Revolusi (korban G30S/PKI)
- Lokasi ini berkaitan dengan peristiwa 1965, bukan kemerdekaan 1945

GUNAKAN FAKTA DI ATAS. JANGAN MENGARANG!
"""

    return ""

# ==================== TESTING ====================

if __name__ == "__main__":
    # Test query detection
    test_queries = [
        "Siapa itu pahlawan revolusi?",
        "Siapa saja patung di Lubang Buaya?",
        "Jelaskan peristiwa G30S/PKI",
        "Apa perbedaan pahlawan nasional dan pahlawan revolusi?"
    ]

    print("=== Testing Query Detection ===\n")
    for query in test_queries:
        print(f"Query: {query}")
        facts_data = retrieve_historical_facts(query)
        if facts_data:
            print(f"Type: {facts_data['type']}")
            formatted = format_facts_for_prompt(facts_data)
            print(f"Facts preview: {formatted[:200]}...")
        else:
            print("Type: None (no historical facts needed)")
        print("-" * 80)
